#!/usr/bin/env node

const fs = require('fs')
const path = require('path')
const chalk = require('chalk')

// Configuration
const LOCALES_DIR = path.join(__dirname, '..', 'src', 'locales')
const SUPPORTED_LANGUAGES = ['en', 'es', 'fr', 'de', 'zh-TW', 'zh-CN']
const NAMESPACES = [
  'common',
  'auth',
  'errors',
  'logbook',
  'reports',
  'scorebook',
  'toolbox',
]
const REFERENCE_LANGUAGE = 'en'
const NEEDS_TRANSLATION_PREFIX = '[NEEDS TRANSLATION] '

// Language names for better reporting
const LANGUAGE_NAMES = {
  en: 'English',
  es: 'Spanish',
  fr: 'French',
  de: 'German',
  'zh-TW': 'Traditional Chinese',
  'zh-CN': 'Simplified Chinese',
}

// Helper to load JSON file
function loadJsonFile(filePath) {
  try {
    return JSON.parse(fs.readFileSync(filePath, 'utf8'))
  } catch (error) {
    console.error(chalk.red(`Error loading ${filePath}:`), error.message)
    return null
  }
}

// Helper to save JSON file
function saveJsonFile(filePath, data) {
  fs.writeFileSync(filePath, JSON.stringify(data, null, 2) + '\n')
}

// Find all keys needing translation in an object
function findNeedsTranslation(obj, path = '') {
  const results = []

  for (const key in obj) {
    const fullPath = path ? `${path}.${key}` : key
    const value = obj[key]

    if (
      typeof value === 'string' &&
      value.startsWith(NEEDS_TRANSLATION_PREFIX)
    ) {
      results.push({
        path: fullPath,
        value: value.replace(NEEDS_TRANSLATION_PREFIX, ''),
        originalValue: value,
      })
    } else if (
      typeof value === 'object' &&
      value !== null &&
      !Array.isArray(value)
    ) {
      results.push(...findNeedsTranslation(value, fullPath))
    }
  }

  return results
}

// Get value by dot notation path
function getValueByPath(obj, path) {
  return path.split('.').reduce((acc, part) => acc && acc[part], obj)
}

// Set value by dot notation path
function setValueByPath(obj, path, value) {
  const parts = path.split('.')
  const last = parts.pop()
  const target = parts.reduce((acc, part) => {
    if (!acc[part]) acc[part] = {}
    return acc[part]
  }, obj)
  target[last] = value
}

// Generate translation suggestions based on patterns
function generateSuggestion(key, referenceValue, targetLang) {
  // Common UI patterns that can be auto-translated
  const patterns = {
    es: {
      Add: 'AÃ±adir',
      Remove: 'Eliminar',
      Delete: 'Eliminar',
      Save: 'Guardar',
      Cancel: 'Cancelar',
      Close: 'Cerrar',
      Open: 'Abrir',
      Edit: 'Editar',
      Create: 'Crear',
      Update: 'Actualizar',
      Search: 'Buscar',
      Filter: 'Filtrar',
      Sort: 'Ordenar',
      Select: 'Seleccionar',
      Clear: 'Limpiar',
      Reset: 'Restablecer',
      Submit: 'Enviar',
      Confirm: 'Confirmar',
      Yes: 'SÃ­',
      No: 'No',
      OK: 'OK',
      Error: 'Error',
      Warning: 'Advertencia',
      Success: 'Ã‰xito',
      Loading: 'Cargando',
      'Please wait': 'Por favor espere',
      Required: 'Requerido',
      Optional: 'Opcional',
      Settings: 'ConfiguraciÃ³n',
      Profile: 'Perfil',
      Logout: 'Cerrar sesiÃ³n',
      Login: 'Iniciar sesiÃ³n',
      'Sign in': 'Iniciar sesiÃ³n',
      'Sign out': 'Cerrar sesiÃ³n',
      Register: 'Registrarse',
      'Forgot password': 'OlvidÃ© mi contraseÃ±a',
      'Reset password': 'Restablecer contraseÃ±a',
      'Change password': 'Cambiar contraseÃ±a',
      Email: 'Correo electrÃ³nico',
      Password: 'ContraseÃ±a',
      Username: 'Nombre de usuario',
      Name: 'Nombre',
      Description: 'DescripciÃ³n',
      Title: 'TÃ­tulo',
      Date: 'Fecha',
      Time: 'Hora',
      Duration: 'DuraciÃ³n',
      Start: 'Iniciar',
      Stop: 'Detener',
      Pause: 'Pausar',
      Resume: 'Reanudar',
      Previous: 'Anterior',
      Next: 'Siguiente',
      Back: 'AtrÃ¡s',
      Forward: 'Adelante',
      Home: 'Inicio',
      Dashboard: 'Panel',
      Overview: 'Resumen',
      Details: 'Detalles',
      Information: 'InformaciÃ³n',
      Help: 'Ayuda',
      About: 'Acerca de',
      Contact: 'Contacto',
      Support: 'Soporte',
      Documentation: 'DocumentaciÃ³n',
      Download: 'Descargar',
      Upload: 'Subir',
      Import: 'Importar',
      Export: 'Exportar',
      Print: 'Imprimir',
      Share: 'Compartir',
      Copy: 'Copiar',
      Paste: 'Pegar',
      Cut: 'Cortar',
      Undo: 'Deshacer',
      Redo: 'Rehacer',
      Refresh: 'Actualizar',
      Reload: 'Recargar',
      Retry: 'Reintentar',
      'Try again': 'Intentar de nuevo',
      View: 'Ver',
      Show: 'Mostrar',
      Hide: 'Ocultar',
      Expand: 'Expandir',
      Collapse: 'Contraer',
      More: 'MÃ¡s',
      Less: 'Menos',
      All: 'Todo',
      None: 'Ninguno',
      Selected: 'Seleccionado',
      Unselected: 'No seleccionado',
      Active: 'Activo',
      Inactive: 'Inactivo',
      Enabled: 'Habilitado',
      Disabled: 'Deshabilitado',
      On: 'Encendido',
      Off: 'Apagado',
      Default: 'Predeterminado',
      Custom: 'Personalizado',
      Basic: 'BÃ¡sico',
      Advanced: 'Avanzado',
      Simple: 'Simple',
      Complex: 'Complejo',
      Easy: 'FÃ¡cil',
      Hard: 'DifÃ­cil',
      New: 'Nuevo',
      Old: 'Antiguo',
      Recent: 'Reciente',
      Popular: 'Popular',
      Trending: 'Tendencia',
      Featured: 'Destacado',
      Recommended: 'Recomendado',
      Favorite: 'Favorito',
      Like: 'Me gusta',
      Dislike: 'No me gusta',
      Comment: 'Comentario',
      Reply: 'Responder',
      Follow: 'Seguir',
      Unfollow: 'Dejar de seguir',
      Block: 'Bloquear',
      Unblock: 'Desbloquear',
      Report: 'Reportar',
      Flag: 'Marcar',
      'Mark as read': 'Marcar como leÃ­do',
      'Mark as unread': 'Marcar como no leÃ­do',
      Archive: 'Archivar',
      Unarchive: 'Desarchivar',
      Trash: 'Papelera',
      Restore: 'Restaurar',
      'Permanently delete': 'Eliminar permanentemente',
      Move: 'Mover',
      Rename: 'Renombrar',
      Duplicate: 'Duplicar',
      Clone: 'Clonar',
      Merge: 'Fusionar',
      Split: 'Dividir',
      Join: 'Unir',
      Separate: 'Separar',
      Group: 'Agrupar',
      Ungroup: 'Desagrupar',
      Lock: 'Bloquear',
      Unlock: 'Desbloquear',
      Pin: 'Fijar',
      Unpin: 'Desfijar',
      Bookmark: 'Marcador',
      Tag: 'Etiqueta',
      Label: 'Etiqueta',
      Category: 'CategorÃ­a',
      Type: 'Tipo',
      Status: 'Estado',
      Priority: 'Prioridad',
      High: 'Alta',
      Medium: 'Media',
      Low: 'Baja',
      Urgent: 'Urgente',
      Important: 'Importante',
      Normal: 'Normal',
      Minor: 'Menor',
      Major: 'Mayor',
      Critical: 'CrÃ­tico',
      Public: 'PÃºblico',
      Private: 'Privado',
      Draft: 'Borrador',
      Published: 'Publicado',
      Pending: 'Pendiente',
      Approved: 'Aprobado',
      Rejected: 'Rechazado',
      Completed: 'Completado',
      'In progress': 'En progreso',
      'Not started': 'No iniciado',
      Cancelled: 'Cancelado',
      Postponed: 'Pospuesto',
      Scheduled: 'Programado',
      Overdue: 'Vencido',
      Today: 'Hoy',
      Yesterday: 'Ayer',
      Tomorrow: 'MaÃ±ana',
      'This week': 'Esta semana',
      'Last week': 'Semana pasada',
      'Next week': 'PrÃ³xima semana',
      'This month': 'Este mes',
      'Last month': 'Mes pasado',
      'Next month': 'PrÃ³ximo mes',
      'This year': 'Este aÃ±o',
      'Last year': 'AÃ±o pasado',
      'Next year': 'PrÃ³ximo aÃ±o',
      Monday: 'Lunes',
      Tuesday: 'Martes',
      Wednesday: 'MiÃ©rcoles',
      Thursday: 'Jueves',
      Friday: 'Viernes',
      Saturday: 'SÃ¡bado',
      Sunday: 'Domingo',
      January: 'Enero',
      February: 'Febrero',
      March: 'Marzo',
      April: 'Abril',
      May: 'Mayo',
      June: 'Junio',
      July: 'Julio',
      August: 'Agosto',
      September: 'Septiembre',
      October: 'Octubre',
      November: 'Noviembre',
      December: 'Diciembre',
    },
    fr: {
      Add: 'Ajouter',
      Remove: 'Supprimer',
      Delete: 'Supprimer',
      Save: 'Enregistrer',
      Cancel: 'Annuler',
      Close: 'Fermer',
      Open: 'Ouvrir',
      Edit: 'Modifier',
      Create: 'CrÃ©er',
      Update: 'Mettre Ã  jour',
      Search: 'Rechercher',
      Filter: 'Filtrer',
      Sort: 'Trier',
      Select: 'SÃ©lectionner',
      Clear: 'Effacer',
      Reset: 'RÃ©initialiser',
      Submit: 'Soumettre',
      Confirm: 'Confirmer',
      Yes: 'Oui',
      No: 'Non',
      OK: 'OK',
      Error: 'Erreur',
      Warning: 'Avertissement',
      Success: 'SuccÃ¨s',
      Loading: 'Chargement',
      'Please wait': 'Veuillez patienter',
      Required: 'Requis',
      Optional: 'Optionnel',
      Settings: 'ParamÃ¨tres',
      Profile: 'Profil',
      Logout: 'DÃ©connexion',
      Login: 'Connexion',
      'Sign in': 'Se connecter',
      'Sign out': 'Se dÃ©connecter',
      Register: "S'inscrire",
      'Forgot password': 'Mot de passe oubliÃ©',
      'Reset password': 'RÃ©initialiser le mot de passe',
      'Change password': 'Changer le mot de passe',
      Email: 'E-mail',
      Password: 'Mot de passe',
      Username: "Nom d'utilisateur",
      Name: 'Nom',
      Description: 'Description',
      Title: 'Titre',
      Date: 'Date',
      Time: 'Heure',
      Duration: 'DurÃ©e',
      Start: 'DÃ©marrer',
      Stop: 'ArrÃªter',
      Pause: 'Pause',
      Resume: 'Reprendre',
      Previous: 'PrÃ©cÃ©dent',
      Next: 'Suivant',
      Back: 'Retour',
      Forward: 'Avancer',
      Home: 'Accueil',
      Dashboard: 'Tableau de bord',
      Overview: "Vue d'ensemble",
      Details: 'DÃ©tails',
      Information: 'Information',
      Help: 'Aide',
      About: 'Ã€ propos',
      Contact: 'Contact',
      Support: 'Support',
      Documentation: 'Documentation',
      Download: 'TÃ©lÃ©charger',
      Upload: 'TÃ©lÃ©verser',
      Import: 'Importer',
      Export: 'Exporter',
      Print: 'Imprimer',
      Share: 'Partager',
      Copy: 'Copier',
      Paste: 'Coller',
      Cut: 'Couper',
      Undo: 'Annuler',
      Redo: 'RÃ©tablir',
      Refresh: 'Actualiser',
      Reload: 'Recharger',
      Retry: 'RÃ©essayer',
      'Try again': 'RÃ©essayer',
      View: 'Voir',
      Show: 'Afficher',
      Hide: 'Masquer',
      Expand: 'DÃ©velopper',
      Collapse: 'RÃ©duire',
      More: 'Plus',
      Less: 'Moins',
      All: 'Tout',
      None: 'Aucun',
      Selected: 'SÃ©lectionnÃ©',
      Unselected: 'Non sÃ©lectionnÃ©',
      Active: 'Actif',
      Inactive: 'Inactif',
      Enabled: 'ActivÃ©',
      Disabled: 'DÃ©sactivÃ©',
      On: 'ActivÃ©',
      Off: 'DÃ©sactivÃ©',
      Default: 'Par dÃ©faut',
      Custom: 'PersonnalisÃ©',
      Basic: 'Basique',
      Advanced: 'AvancÃ©',
      Simple: 'Simple',
      Complex: 'Complexe',
      Easy: 'Facile',
      Hard: 'Difficile',
      New: 'Nouveau',
      Old: 'Ancien',
      Recent: 'RÃ©cent',
      Popular: 'Populaire',
      Trending: 'Tendance',
      Featured: 'En vedette',
      Recommended: 'RecommandÃ©',
      Favorite: 'Favori',
      Like: 'Aimer',
      Dislike: 'Ne pas aimer',
      Comment: 'Commentaire',
      Reply: 'RÃ©pondre',
      Follow: 'Suivre',
      Unfollow: 'Ne plus suivre',
      Block: 'Bloquer',
      Unblock: 'DÃ©bloquer',
      Report: 'Signaler',
      Flag: 'Signaler',
      'Mark as read': 'Marquer comme lu',
      'Mark as unread': 'Marquer comme non lu',
      Archive: 'Archiver',
      Unarchive: 'DÃ©sarchiver',
      Trash: 'Corbeille',
      Restore: 'Restaurer',
      'Permanently delete': 'Supprimer dÃ©finitivement',
      Move: 'DÃ©placer',
      Rename: 'Renommer',
      Duplicate: 'Dupliquer',
      Clone: 'Cloner',
      Merge: 'Fusionner',
      Split: 'Diviser',
      Join: 'Joindre',
      Separate: 'SÃ©parer',
      Group: 'Grouper',
      Ungroup: 'DÃ©grouper',
      Lock: 'Verrouiller',
      Unlock: 'DÃ©verrouiller',
      Pin: 'Ã‰pingler',
      Unpin: 'DÃ©sÃ©pingler',
      Bookmark: 'Marque-page',
      Tag: 'Ã‰tiquette',
      Label: 'LibellÃ©',
      Category: 'CatÃ©gorie',
      Type: 'Type',
      Status: 'Statut',
      Priority: 'PrioritÃ©',
      High: 'Ã‰levÃ©e',
      Medium: 'Moyenne',
      Low: 'Faible',
      Urgent: 'Urgent',
      Important: 'Important',
      Normal: 'Normal',
      Minor: 'Mineur',
      Major: 'Majeur',
      Critical: 'Critique',
      Public: 'Public',
      Private: 'PrivÃ©',
      Draft: 'Brouillon',
      Published: 'PubliÃ©',
      Pending: 'En attente',
      Approved: 'ApprouvÃ©',
      Rejected: 'RejetÃ©',
      Completed: 'TerminÃ©',
      'In progress': 'En cours',
      'Not started': 'Non commencÃ©',
      Cancelled: 'AnnulÃ©',
      Postponed: 'ReportÃ©',
      Scheduled: 'PlanifiÃ©',
      Overdue: 'En retard',
      Today: "Aujourd'hui",
      Yesterday: 'Hier',
      Tomorrow: 'Demain',
      'This week': 'Cette semaine',
      'Last week': 'Semaine derniÃ¨re',
      'Next week': 'Semaine prochaine',
      'This month': 'Ce mois',
      'Last month': 'Mois dernier',
      'Next month': 'Mois prochain',
      'This year': 'Cette annÃ©e',
      'Last year': 'AnnÃ©e derniÃ¨re',
      'Next year': 'AnnÃ©e prochaine',
      Monday: 'Lundi',
      Tuesday: 'Mardi',
      Wednesday: 'Mercredi',
      Thursday: 'Jeudi',
      Friday: 'Vendredi',
      Saturday: 'Samedi',
      Sunday: 'Dimanche',
      January: 'Janvier',
      February: 'FÃ©vrier',
      March: 'Mars',
      April: 'Avril',
      May: 'Mai',
      June: 'Juin',
      July: 'Juillet',
      August: 'AoÃ»t',
      September: 'Septembre',
      October: 'Octobre',
      November: 'Novembre',
      December: 'DÃ©cembre',
    },
    de: {
      Add: 'HinzufÃ¼gen',
      Remove: 'Entfernen',
      Delete: 'LÃ¶schen',
      Save: 'Speichern',
      Cancel: 'Abbrechen',
      Close: 'SchlieÃŸen',
      Open: 'Ã–ffnen',
      Edit: 'Bearbeiten',
      Create: 'Erstellen',
      Update: 'Aktualisieren',
      Search: 'Suchen',
      Filter: 'Filtern',
      Sort: 'Sortieren',
      Select: 'AuswÃ¤hlen',
      Clear: 'LÃ¶schen',
      Reset: 'ZurÃ¼cksetzen',
      Submit: 'Absenden',
      Confirm: 'BestÃ¤tigen',
      Yes: 'Ja',
      No: 'Nein',
      OK: 'OK',
      Error: 'Fehler',
      Warning: 'Warnung',
      Success: 'Erfolg',
      Loading: 'Laden',
      'Please wait': 'Bitte warten',
      Required: 'Erforderlich',
      Optional: 'Optional',
      Settings: 'Einstellungen',
      Profile: 'Profil',
      Logout: 'Abmelden',
      Login: 'Anmelden',
      'Sign in': 'Anmelden',
      'Sign out': 'Abmelden',
      Register: 'Registrieren',
      'Forgot password': 'Passwort vergessen',
      'Reset password': 'Passwort zurÃ¼cksetzen',
      'Change password': 'Passwort Ã¤ndern',
      Email: 'E-Mail',
      Password: 'Passwort',
      Username: 'Benutzername',
      Name: 'Name',
      Description: 'Beschreibung',
      Title: 'Titel',
      Date: 'Datum',
      Time: 'Zeit',
      Duration: 'Dauer',
      Start: 'Starten',
      Stop: 'Stoppen',
      Pause: 'Pause',
      Resume: 'Fortsetzen',
      Previous: 'Vorherige',
      Next: 'NÃ¤chste',
      Back: 'ZurÃ¼ck',
      Forward: 'VorwÃ¤rts',
      Home: 'Startseite',
      Dashboard: 'Dashboard',
      Overview: 'Ãœbersicht',
      Details: 'Details',
      Information: 'Information',
      Help: 'Hilfe',
      About: 'Ãœber',
      Contact: 'Kontakt',
      Support: 'UnterstÃ¼tzung',
      Documentation: 'Dokumentation',
      Download: 'Herunterladen',
      Upload: 'Hochladen',
      Import: 'Importieren',
      Export: 'Exportieren',
      Print: 'Drucken',
      Share: 'Teilen',
      Copy: 'Kopieren',
      Paste: 'EinfÃ¼gen',
      Cut: 'Ausschneiden',
      Undo: 'RÃ¼ckgÃ¤ngig',
      Redo: 'Wiederholen',
      Refresh: 'Aktualisieren',
      Reload: 'Neu laden',
      Retry: 'Wiederholen',
      'Try again': 'Erneut versuchen',
      View: 'Ansehen',
      Show: 'Anzeigen',
      Hide: 'Ausblenden',
      Expand: 'Erweitern',
      Collapse: 'Reduzieren',
      More: 'Mehr',
      Less: 'Weniger',
      All: 'Alle',
      None: 'Keine',
      Selected: 'AusgewÃ¤hlt',
      Unselected: 'Nicht ausgewÃ¤hlt',
      Active: 'Aktiv',
      Inactive: 'Inaktiv',
      Enabled: 'Aktiviert',
      Disabled: 'Deaktiviert',
      On: 'Ein',
      Off: 'Aus',
      Default: 'Standard',
      Custom: 'Benutzerdefiniert',
      Basic: 'Basis',
      Advanced: 'Erweitert',
      Simple: 'Einfach',
      Complex: 'Komplex',
      Easy: 'Einfach',
      Hard: 'Schwer',
      New: 'Neu',
      Old: 'Alt',
      Recent: 'KÃ¼rzlich',
      Popular: 'Beliebt',
      Trending: 'Trend',
      Featured: 'Vorgestellt',
      Recommended: 'Empfohlen',
      Favorite: 'Favorit',
      Like: 'GefÃ¤llt mir',
      Dislike: 'GefÃ¤llt mir nicht',
      Comment: 'Kommentar',
      Reply: 'Antworten',
      Follow: 'Folgen',
      Unfollow: 'Entfolgen',
      Block: 'Blockieren',
      Unblock: 'Blockierung aufheben',
      Report: 'Melden',
      Flag: 'Markieren',
      'Mark as read': 'Als gelesen markieren',
      'Mark as unread': 'Als ungelesen markieren',
      Archive: 'Archivieren',
      Unarchive: 'Aus Archiv entfernen',
      Trash: 'Papierkorb',
      Restore: 'Wiederherstellen',
      'Permanently delete': 'Dauerhaft lÃ¶schen',
      Move: 'Verschieben',
      Rename: 'Umbenennen',
      Duplicate: 'Duplizieren',
      Clone: 'Klonen',
      Merge: 'ZusammenfÃ¼hren',
      Split: 'Teilen',
      Join: 'Verbinden',
      Separate: 'Trennen',
      Group: 'Gruppieren',
      Ungroup: 'Gruppierung aufheben',
      Lock: 'Sperren',
      Unlock: 'Entsperren',
      Pin: 'Anheften',
      Unpin: 'LoslÃ¶sen',
      Bookmark: 'Lesezeichen',
      Tag: 'Tag',
      Label: 'Bezeichnung',
      Category: 'Kategorie',
      Type: 'Typ',
      Status: 'Status',
      Priority: 'PrioritÃ¤t',
      High: 'Hoch',
      Medium: 'Mittel',
      Low: 'Niedrig',
      Urgent: 'Dringend',
      Important: 'Wichtig',
      Normal: 'Normal',
      Minor: 'Gering',
      Major: 'GroÃŸ',
      Critical: 'Kritisch',
      Public: 'Ã–ffentlich',
      Private: 'Privat',
      Draft: 'Entwurf',
      Published: 'VerÃ¶ffentlicht',
      Pending: 'Ausstehend',
      Approved: 'Genehmigt',
      Rejected: 'Abgelehnt',
      Completed: 'Abgeschlossen',
      'In progress': 'In Bearbeitung',
      'Not started': 'Nicht gestartet',
      Cancelled: 'Abgebrochen',
      Postponed: 'Verschoben',
      Scheduled: 'Geplant',
      Overdue: 'ÃœberfÃ¤llig',
      Today: 'Heute',
      Yesterday: 'Gestern',
      Tomorrow: 'Morgen',
      'This week': 'Diese Woche',
      'Last week': 'Letzte Woche',
      'Next week': 'NÃ¤chste Woche',
      'This month': 'Diesen Monat',
      'Last month': 'Letzten Monat',
      'Next month': 'NÃ¤chsten Monat',
      'This year': 'Dieses Jahr',
      'Last year': 'Letztes Jahr',
      'Next year': 'NÃ¤chstes Jahr',
      Monday: 'Montag',
      Tuesday: 'Dienstag',
      Wednesday: 'Mittwoch',
      Thursday: 'Donnerstag',
      Friday: 'Freitag',
      Saturday: 'Samstag',
      Sunday: 'Sonntag',
      January: 'Januar',
      February: 'Februar',
      March: 'MÃ¤rz',
      April: 'April',
      May: 'Mai',
      June: 'Juni',
      July: 'Juli',
      August: 'August',
      September: 'September',
      October: 'Oktober',
      November: 'November',
      December: 'Dezember',
    },
    'zh-TW': {
      Add: 'æ–°å¢ž',
      Remove: 'ç§»é™¤',
      Delete: 'åˆªé™¤',
      Save: 'å„²å­˜',
      Cancel: 'å–æ¶ˆ',
      Close: 'é—œé–‰',
      Open: 'é–‹å•Ÿ',
      Edit: 'ç·¨è¼¯',
      Create: 'å»ºç«‹',
      Update: 'æ›´æ–°',
      Search: 'æœå°‹',
      Filter: 'ç¯©é¸',
      Sort: 'æŽ’åº',
      Select: 'é¸æ“‡',
      Clear: 'æ¸…é™¤',
      Reset: 'é‡è¨­',
      Submit: 'æäº¤',
      Confirm: 'ç¢ºèª',
      Yes: 'æ˜¯',
      No: 'å¦',
      OK: 'ç¢ºå®š',
      Error: 'éŒ¯èª¤',
      Warning: 'è­¦å‘Š',
      Success: 'æˆåŠŸ',
      Loading: 'è¼‰å…¥ä¸­',
      'Please wait': 'è«‹ç¨å€™',
      Required: 'å¿…å¡«',
      Optional: 'é¸å¡«',
      Settings: 'è¨­å®š',
      Profile: 'å€‹äººè³‡æ–™',
      Logout: 'ç™»å‡º',
      Login: 'ç™»å…¥',
      'Sign in': 'ç™»å…¥',
      'Sign out': 'ç™»å‡º',
      Register: 'è¨»å†Š',
      'Forgot password': 'å¿˜è¨˜å¯†ç¢¼',
      'Reset password': 'é‡è¨­å¯†ç¢¼',
      'Change password': 'è®Šæ›´å¯†ç¢¼',
      Email: 'é›»å­éƒµä»¶',
      Password: 'å¯†ç¢¼',
      Username: 'ä½¿ç”¨è€…åç¨±',
      Name: 'åç¨±',
      Description: 'æè¿°',
      Title: 'æ¨™é¡Œ',
      Date: 'æ—¥æœŸ',
      Time: 'æ™‚é–“',
      Duration: 'æŒçºŒæ™‚é–“',
      Start: 'é–‹å§‹',
      Stop: 'åœæ­¢',
      Pause: 'æš«åœ',
      Resume: 'ç¹¼çºŒ',
      Previous: 'ä¸Šä¸€å€‹',
      Next: 'ä¸‹ä¸€å€‹',
      Back: 'è¿”å›ž',
      Forward: 'å‰é€²',
      Home: 'é¦–é ',
      Dashboard: 'å„€è¡¨æ¿',
      Overview: 'ç¸½è¦½',
      Details: 'è©³ç´°è³‡æ–™',
      Information: 'è³‡è¨Š',
      Help: 'èªªæ˜Ž',
      About: 'é—œæ–¼',
      Contact: 'è¯çµ¡',
      Support: 'æ”¯æ´',
      Documentation: 'æ–‡ä»¶',
      Download: 'ä¸‹è¼‰',
      Upload: 'ä¸Šå‚³',
      Import: 'åŒ¯å…¥',
      Export: 'åŒ¯å‡º',
      Print: 'åˆ—å°',
      Share: 'åˆ†äº«',
      Copy: 'è¤‡è£½',
      Paste: 'è²¼ä¸Š',
      Cut: 'å‰ªä¸‹',
      Undo: 'å¾©åŽŸ',
      Redo: 'é‡åš',
      Refresh: 'é‡æ–°æ•´ç†',
      Reload: 'é‡æ–°è¼‰å…¥',
      Retry: 'é‡è©¦',
      'Try again': 'å†è©¦ä¸€æ¬¡',
      View: 'æª¢è¦–',
      Show: 'é¡¯ç¤º',
      Hide: 'éš±è—',
      Expand: 'å±•é–‹',
      Collapse: 'æ”¶åˆ',
      More: 'æ›´å¤š',
      Less: 'æ›´å°‘',
      All: 'å…¨éƒ¨',
      None: 'ç„¡',
      Selected: 'å·²é¸æ“‡',
      Unselected: 'æœªé¸æ“‡',
      Active: 'å•Ÿç”¨',
      Inactive: 'åœç”¨',
      Enabled: 'å·²å•Ÿç”¨',
      Disabled: 'å·²åœç”¨',
      On: 'é–‹',
      Off: 'é—œ',
      Default: 'é è¨­',
      Custom: 'è‡ªè¨‚',
      Basic: 'åŸºæœ¬',
      Advanced: 'é€²éšŽ',
      Simple: 'ç°¡å–®',
      Complex: 'è¤‡é›œ',
      Easy: 'ç°¡å–®',
      Hard: 'å›°é›£',
      New: 'æ–°å¢ž',
      Old: 'èˆŠçš„',
      Recent: 'æœ€è¿‘',
      Popular: 'ç†±é–€',
      Trending: 'è¶¨å‹¢',
      Featured: 'ç²¾é¸',
      Recommended: 'æŽ¨è–¦',
      Favorite: 'æœ€æ„›',
      Like: 'å–œæ­¡',
      Dislike: 'ä¸å–œæ­¡',
      Comment: 'è©•è«–',
      Reply: 'å›žè¦†',
      Follow: 'è¿½è¹¤',
      Unfollow: 'å–æ¶ˆè¿½è¹¤',
      Block: 'å°éŽ–',
      Unblock: 'è§£é™¤å°éŽ–',
      Report: 'æª¢èˆ‰',
      Flag: 'æ¨™è¨˜',
      'Mark as read': 'æ¨™è¨˜ç‚ºå·²è®€',
      'Mark as unread': 'æ¨™è¨˜ç‚ºæœªè®€',
      Archive: 'å°å­˜',
      Unarchive: 'å–æ¶ˆå°å­˜',
      Trash: 'åžƒåœ¾æ¡¶',
      Restore: 'é‚„åŽŸ',
      'Permanently delete': 'æ°¸ä¹…åˆªé™¤',
      Move: 'ç§»å‹•',
      Rename: 'é‡æ–°å‘½å',
      Duplicate: 'è¤‡è£½',
      Clone: 'è¤‡è£½',
      Merge: 'åˆä½µ',
      Split: 'åˆ†å‰²',
      Join: 'åŠ å…¥',
      Separate: 'åˆ†é›¢',
      Group: 'ç¾¤çµ„',
      Ungroup: 'å–æ¶ˆç¾¤çµ„',
      Lock: 'éŽ–å®š',
      Unlock: 'è§£éŽ–',
      Pin: 'é‡˜é¸',
      Unpin: 'å–æ¶ˆé‡˜é¸',
      Bookmark: 'æ›¸ç±¤',
      Tag: 'æ¨™ç±¤',
      Label: 'æ¨™ç±¤',
      Category: 'é¡žåˆ¥',
      Type: 'é¡žåž‹',
      Status: 'ç‹€æ…‹',
      Priority: 'å„ªå…ˆé †åº',
      High: 'é«˜',
      Medium: 'ä¸­',
      Low: 'ä½Ž',
      Urgent: 'ç·Šæ€¥',
      Important: 'é‡è¦',
      Normal: 'ä¸€èˆ¬',
      Minor: 'æ¬¡è¦',
      Major: 'ä¸»è¦',
      Critical: 'é—œéµ',
      Public: 'å…¬é–‹',
      Private: 'ç§äºº',
      Draft: 'è‰ç¨¿',
      Published: 'å·²ç™¼å¸ƒ',
      Pending: 'å¾…è™•ç†',
      Approved: 'å·²æ ¸å‡†',
      Rejected: 'å·²æ‹’çµ•',
      Completed: 'å·²å®Œæˆ',
      'In progress': 'é€²è¡Œä¸­',
      'Not started': 'æœªé–‹å§‹',
      Cancelled: 'å·²å–æ¶ˆ',
      Postponed: 'å·²å»¶å¾Œ',
      Scheduled: 'å·²æŽ’ç¨‹',
      Overdue: 'é€¾æœŸ',
      Today: 'ä»Šå¤©',
      Yesterday: 'æ˜¨å¤©',
      Tomorrow: 'æ˜Žå¤©',
      'This week': 'æœ¬é€±',
      'Last week': 'ä¸Šé€±',
      'Next week': 'ä¸‹é€±',
      'This month': 'æœ¬æœˆ',
      'Last month': 'ä¸Šå€‹æœˆ',
      'Next month': 'ä¸‹å€‹æœˆ',
      'This year': 'ä»Šå¹´',
      'Last year': 'åŽ»å¹´',
      'Next year': 'æ˜Žå¹´',
      Monday: 'æ˜ŸæœŸä¸€',
      Tuesday: 'æ˜ŸæœŸäºŒ',
      Wednesday: 'æ˜ŸæœŸä¸‰',
      Thursday: 'æ˜ŸæœŸå››',
      Friday: 'æ˜ŸæœŸäº”',
      Saturday: 'æ˜ŸæœŸå…­',
      Sunday: 'æ˜ŸæœŸæ—¥',
      January: 'ä¸€æœˆ',
      February: 'äºŒæœˆ',
      March: 'ä¸‰æœˆ',
      April: 'å››æœˆ',
      May: 'äº”æœˆ',
      June: 'å…­æœˆ',
      July: 'ä¸ƒæœˆ',
      August: 'å…«æœˆ',
      September: 'ä¹æœˆ',
      October: 'åæœˆ',
      November: 'åä¸€æœˆ',
      December: 'åäºŒæœˆ',
    },
    'zh-CN': {
      Add: 'æ·»åŠ ',
      Remove: 'ç§»é™¤',
      Delete: 'åˆ é™¤',
      Save: 'ä¿å­˜',
      Cancel: 'å–æ¶ˆ',
      Close: 'å…³é—­',
      Open: 'æ‰“å¼€',
      Edit: 'ç¼–è¾‘',
      Create: 'åˆ›å»º',
      Update: 'æ›´æ–°',
      Search: 'æœç´¢',
      Filter: 'ç­›é€‰',
      Sort: 'æŽ’åº',
      Select: 'é€‰æ‹©',
      Clear: 'æ¸…é™¤',
      Reset: 'é‡ç½®',
      Submit: 'æäº¤',
      Confirm: 'ç¡®è®¤',
      Yes: 'æ˜¯',
      No: 'å¦',
      OK: 'ç¡®å®š',
      Error: 'é”™è¯¯',
      Warning: 'è­¦å‘Š',
      Success: 'æˆåŠŸ',
      Loading: 'åŠ è½½ä¸­',
      'Please wait': 'è¯·ç¨å€™',
      Required: 'å¿…å¡«',
      Optional: 'é€‰å¡«',
      Settings: 'è®¾ç½®',
      Profile: 'ä¸ªäººèµ„æ–™',
      Logout: 'é€€å‡º',
      Login: 'ç™»å½•',
      'Sign in': 'ç™»å½•',
      'Sign out': 'é€€å‡º',
      Register: 'æ³¨å†Œ',
      'Forgot password': 'å¿˜è®°å¯†ç ',
      'Reset password': 'é‡ç½®å¯†ç ',
      'Change password': 'æ›´æ”¹å¯†ç ',
      Email: 'ç”µå­é‚®ä»¶',
      Password: 'å¯†ç ',
      Username: 'ç”¨æˆ·å',
      Name: 'åç§°',
      Description: 'æè¿°',
      Title: 'æ ‡é¢˜',
      Date: 'æ—¥æœŸ',
      Time: 'æ—¶é—´',
      Duration: 'æ—¶é•¿',
      Start: 'å¼€å§‹',
      Stop: 'åœæ­¢',
      Pause: 'æš‚åœ',
      Resume: 'ç»§ç»­',
      Previous: 'ä¸Šä¸€ä¸ª',
      Next: 'ä¸‹ä¸€ä¸ª',
      Back: 'è¿”å›ž',
      Forward: 'å‰è¿›',
      Home: 'é¦–é¡µ',
      Dashboard: 'ä»ªè¡¨ç›˜',
      Overview: 'æ¦‚è§ˆ',
      Details: 'è¯¦æƒ…',
      Information: 'ä¿¡æ¯',
      Help: 'å¸®åŠ©',
      About: 'å…³äºŽ',
      Contact: 'è”ç³»',
      Support: 'æ”¯æŒ',
      Documentation: 'æ–‡æ¡£',
      Download: 'ä¸‹è½½',
      Upload: 'ä¸Šä¼ ',
      Import: 'å¯¼å…¥',
      Export: 'å¯¼å‡º',
      Print: 'æ‰“å°',
      Share: 'åˆ†äº«',
      Copy: 'å¤åˆ¶',
      Paste: 'ç²˜è´´',
      Cut: 'å‰ªåˆ‡',
      Undo: 'æ’¤é”€',
      Redo: 'é‡åš',
      Refresh: 'åˆ·æ–°',
      Reload: 'é‡æ–°åŠ è½½',
      Retry: 'é‡è¯•',
      'Try again': 'å†è¯•ä¸€æ¬¡',
      View: 'æŸ¥çœ‹',
      Show: 'æ˜¾ç¤º',
      Hide: 'éšè—',
      Expand: 'å±•å¼€',
      Collapse: 'æ”¶èµ·',
      More: 'æ›´å¤š',
      Less: 'æ›´å°‘',
      All: 'å…¨éƒ¨',
      None: 'æ— ',
      Selected: 'å·²é€‰æ‹©',
      Unselected: 'æœªé€‰æ‹©',
      Active: 'æ´»åŠ¨',
      Inactive: 'éžæ´»åŠ¨',
      Enabled: 'å·²å¯ç”¨',
      Disabled: 'å·²ç¦ç”¨',
      On: 'å¼€',
      Off: 'å…³',
      Default: 'é»˜è®¤',
      Custom: 'è‡ªå®šä¹‰',
      Basic: 'åŸºæœ¬',
      Advanced: 'é«˜çº§',
      Simple: 'ç®€å•',
      Complex: 'å¤æ‚',
      Easy: 'å®¹æ˜“',
      Hard: 'å›°éš¾',
      New: 'æ–°å»º',
      Old: 'æ—§çš„',
      Recent: 'æœ€è¿‘',
      Popular: 'çƒ­é—¨',
      Trending: 'è¶‹åŠ¿',
      Featured: 'ç²¾é€‰',
      Recommended: 'æŽ¨è',
      Favorite: 'æ”¶è—',
      Like: 'å–œæ¬¢',
      Dislike: 'ä¸å–œæ¬¢',
      Comment: 'è¯„è®º',
      Reply: 'å›žå¤',
      Follow: 'å…³æ³¨',
      Unfollow: 'å–æ¶ˆå…³æ³¨',
      Block: 'å±è”½',
      Unblock: 'è§£é™¤å±è”½',
      Report: 'ä¸¾æŠ¥',
      Flag: 'æ ‡è®°',
      'Mark as read': 'æ ‡è®°ä¸ºå·²è¯»',
      'Mark as unread': 'æ ‡è®°ä¸ºæœªè¯»',
      Archive: 'å½’æ¡£',
      Unarchive: 'å–æ¶ˆå½’æ¡£',
      Trash: 'å›žæ”¶ç«™',
      Restore: 'æ¢å¤',
      'Permanently delete': 'æ°¸ä¹…åˆ é™¤',
      Move: 'ç§»åŠ¨',
      Rename: 'é‡å‘½å',
      Duplicate: 'å¤åˆ¶',
      Clone: 'å…‹éš†',
      Merge: 'åˆå¹¶',
      Split: 'æ‹†åˆ†',
      Join: 'åŠ å…¥',
      Separate: 'åˆ†ç¦»',
      Group: 'åˆ†ç»„',
      Ungroup: 'å–æ¶ˆåˆ†ç»„',
      Lock: 'é”å®š',
      Unlock: 'è§£é”',
      Pin: 'å›ºå®š',
      Unpin: 'å–æ¶ˆå›ºå®š',
      Bookmark: 'ä¹¦ç­¾',
      Tag: 'æ ‡ç­¾',
      Label: 'æ ‡ç­¾',
      Category: 'ç±»åˆ«',
      Type: 'ç±»åž‹',
      Status: 'çŠ¶æ€',
      Priority: 'ä¼˜å…ˆçº§',
      High: 'é«˜',
      Medium: 'ä¸­',
      Low: 'ä½Ž',
      Urgent: 'ç´§æ€¥',
      Important: 'é‡è¦',
      Normal: 'æ­£å¸¸',
      Minor: 'æ¬¡è¦',
      Major: 'ä¸»è¦',
      Critical: 'å…³é”®',
      Public: 'å…¬å¼€',
      Private: 'ç§å¯†',
      Draft: 'è‰ç¨¿',
      Published: 'å·²å‘å¸ƒ',
      Pending: 'å¾…å¤„ç†',
      Approved: 'å·²æ‰¹å‡†',
      Rejected: 'å·²æ‹’ç»',
      Completed: 'å·²å®Œæˆ',
      'In progress': 'è¿›è¡Œä¸­',
      'Not started': 'æœªå¼€å§‹',
      Cancelled: 'å·²å–æ¶ˆ',
      Postponed: 'å·²æŽ¨è¿Ÿ',
      Scheduled: 'å·²è®¡åˆ’',
      Overdue: 'é€¾æœŸ',
      Today: 'ä»Šå¤©',
      Yesterday: 'æ˜¨å¤©',
      Tomorrow: 'æ˜Žå¤©',
      'This week': 'æœ¬å‘¨',
      'Last week': 'ä¸Šå‘¨',
      'Next week': 'ä¸‹å‘¨',
      'This month': 'æœ¬æœˆ',
      'Last month': 'ä¸Šä¸ªæœˆ',
      'Next month': 'ä¸‹ä¸ªæœˆ',
      'This year': 'ä»Šå¹´',
      'Last year': 'åŽ»å¹´',
      'Next year': 'æ˜Žå¹´',
      Monday: 'æ˜ŸæœŸä¸€',
      Tuesday: 'æ˜ŸæœŸäºŒ',
      Wednesday: 'æ˜ŸæœŸä¸‰',
      Thursday: 'æ˜ŸæœŸå››',
      Friday: 'æ˜ŸæœŸäº”',
      Saturday: 'æ˜ŸæœŸå…­',
      Sunday: 'æ˜ŸæœŸæ—¥',
      January: 'ä¸€æœˆ',
      February: 'äºŒæœˆ',
      March: 'ä¸‰æœˆ',
      April: 'å››æœˆ',
      May: 'äº”æœˆ',
      June: 'å…­æœˆ',
      July: 'ä¸ƒæœˆ',
      August: 'å…«æœˆ',
      September: 'ä¹æœˆ',
      October: 'åæœˆ',
      November: 'åä¸€æœˆ',
      December: 'åäºŒæœˆ',
    },
  }

  // Try exact match first
  if (patterns[targetLang] && patterns[targetLang][referenceValue]) {
    return patterns[targetLang][referenceValue]
  }

  // Try case-insensitive match
  const lowerRef = referenceValue.toLowerCase()
  for (const [key, value] of Object.entries(patterns[targetLang] || {})) {
    if (key.toLowerCase() === lowerRef) {
      return value
    }
  }

  return null
}

// Process a single namespace/language
function processTranslations(namespace, lang, options = {}) {
  const langPath = path.join(LOCALES_DIR, lang, `${namespace}.json`)
  const langData = loadJsonFile(langPath)

  if (!langData) {
    console.error(chalk.red(`Could not load ${lang} file for ${namespace}`))
    return 0
  }

  // Load reference data for suggestions
  const referencePath = path.join(
    LOCALES_DIR,
    REFERENCE_LANGUAGE,
    `${namespace}.json`
  )
  const referenceData = loadJsonFile(referencePath)

  const needsTranslation = findNeedsTranslation(langData)

  if (needsTranslation.length === 0) {
    return 0
  }

  let updated = 0

  needsTranslation.forEach(({ path: keyPath, value }) => {
    // Get reference value for context
    const referenceValue = referenceData
      ? getValueByPath(referenceData, keyPath)
      : null

    // Try to generate a suggestion
    const suggestion = generateSuggestion(keyPath, referenceValue, lang)

    if (suggestion && options.autoTranslate) {
      setValueByPath(langData, keyPath, suggestion)
      console.log(
        chalk.green(`  âœ“ Auto-translated: ${keyPath} â†’ "${suggestion}"`)
      )
      updated++
    } else if (options.showSuggestions && suggestion) {
      console.log(
        chalk.yellow(`  ? ${keyPath}: "${value}" â†’ Suggestion: "${suggestion}"`)
      )
    } else if (options.verbose) {
      console.log(chalk.gray(`  - ${keyPath}: "${value}"`))
    }
  })

  if (updated > 0 && !options.dryRun) {
    saveJsonFile(langPath, langData)
  }

  return updated
}

// Main function
function main() {
  const args = process.argv.slice(2)
  const options = {
    autoTranslate: args.includes('--auto'),
    showSuggestions: args.includes('--suggest'),
    verbose: args.includes('--verbose'),
    dryRun: args.includes('--dry-run'),
    namespace: null,
    language: null,
  }

  // Parse namespace and language options
  const namespaceIndex = args.findIndex(arg => arg === '--namespace')
  if (namespaceIndex !== -1 && args[namespaceIndex + 1]) {
    options.namespace = args[namespaceIndex + 1]
  }

  const languageIndex = args.findIndex(arg => arg === '--language')
  if (languageIndex !== -1 && args[languageIndex + 1]) {
    options.language = args[languageIndex + 1]
  }

  console.log(chalk.bold.cyan('ðŸŒ Translation Helper Tool'))
  console.log(chalk.gray('Finding and helping with missing translations\n'))

  if (options.dryRun) {
    console.log(chalk.yellow('ðŸ” DRY RUN MODE - No files will be modified\n'))
  }

  let totalNeedsTranslation = 0
  let totalAutoTranslated = 0

  // Process specified namespace/language or all
  const namespacesToProcess = options.namespace
    ? [options.namespace]
    : NAMESPACES
  const languagesToProcess = options.language
    ? [options.language]
    : SUPPORTED_LANGUAGES.filter(l => l !== REFERENCE_LANGUAGE)

  namespacesToProcess.forEach(namespace => {
    console.log(chalk.blue(`\nNamespace: ${namespace}`))

    languagesToProcess.forEach(lang => {
      const langPath = path.join(LOCALES_DIR, lang, `${namespace}.json`)
      const langData = loadJsonFile(langPath)

      if (!langData) {
        return
      }

      const needsTranslation = findNeedsTranslation(langData)
      totalNeedsTranslation += needsTranslation.length

      if (needsTranslation.length > 0) {
        console.log(
          chalk.cyan(
            `\n${LANGUAGE_NAMES[lang]} (${lang}): ${needsTranslation.length} translations needed`
          )
        )

        const updated = processTranslations(namespace, lang, options)
        totalAutoTranslated += updated
      }
    })
  })

  // Summary
  console.log(chalk.gray('\n' + '='.repeat(60)))
  console.log(chalk.bold('\nðŸ“Š Summary:'))
  console.log(`Total translations needed: ${totalNeedsTranslation}`)

  if (options.autoTranslate) {
    console.log(chalk.green(`Auto-translated: ${totalAutoTranslated}`))
    console.log(
      chalk.yellow(
        `Still needs manual translation: ${totalNeedsTranslation - totalAutoTranslated}`
      )
    )
  }

  // Help text
  if (!options.autoTranslate && !options.showSuggestions) {
    console.log(chalk.gray('\nOptions:'))
    console.log(chalk.gray('  --auto          Auto-translate common UI terms'))
    console.log(chalk.gray('  --suggest       Show translation suggestions'))
    console.log(
      chalk.gray('  --verbose       Show all keys needing translation')
    )
    console.log(chalk.gray('  --dry-run       Preview changes without saving'))
    console.log(chalk.gray('  --namespace <n> Process specific namespace only'))
    console.log(chalk.gray('  --language <l>  Process specific language only'))
    console.log(
      chalk.gray('\nExample: npm run translate:missing -- --auto --suggest')
    )
  }
}

// Run the script
main()
